"use strict";var ckc=angular.module("ckc",["ngRoute","ngSanitize","firebase"]);
function adminChannelSellector(){n.$inject=["scope","el","attr","ctrl"];var e={restrict:"AECM",templateUrl:"assets/views/adminChannelSellector-directive.htm",replace:!0,scope:{merchantId:"=",channelId:"="},link:n,controller:c,controllerAs:"vm",bindToController:!0};function n(a,e,n,c){a.$watch("channelName",function(n,e){n&&Object.keys(a.vm.channels).forEach(function(e){null!=a.vm.channels[e]&&a.vm.channels[e].name==n&&(a.vm.channelId=e)})}),a.$watch("merchantId",function(e,n){var c;null!=a.vm.merchantId&&(c="/Merchants/"+a.vm.merchantId+"/Channels",a.vm.initFirebase(c))})}function c(e,n,c){e.channelName="";var a=this;a.initFirebase=function(e){console.log("init firebase",e);e=firebase.database().ref(e);a.channels=c(e)}}return c.$inject=["$scope","$log","$firebaseObject"],e}ckc.directive("adminChannelSellector",adminChannelSellector);
function adminEventSellector(){n.$inject=["scope","el","attr","ctrl"];var e={restrict:"AECM",templateUrl:"assets/views/adminEventSellector-directive.htm",replace:!0,scope:{merchantId:"=",channelId:"=",seasonId:"=",eventId:"=",eventData:"="},link:n,controller:t,controllerAs:"vm",bindToController:!0};function n(o,e,n,t){o.$watch("eventWeek",function(n,e){n&&Object.keys(o.vm.events).forEach(function(e){null!=o.vm.events[e]&&o.vm.events[e].weekNum==n&&(o.vm.eventId=e,o.vm.eventData=o.vm.events[e])})}),o.$watch("seasonId",function(e,n){var t;null!=o.vm.seasonId&&(t="/Merchants/"+o.vm.merchantId+"/Events",o.vm.initFirebase(t))})}function t(n,e,t){console.log("adminEventSellectorController"),n.eventWeek="";var o=this;o.initFirebase=function(e){console.log("init firebase",e);e=firebase.database().ref(e).orderByChild("externalIds/seasonId").equalTo(n.vm.seasonId);o.events=t(e),console.log(o.events)}}return t.$inject=["$scope","$log","$firebaseObject"],e}ckc.directive("adminEventSellector",adminEventSellector);
function adminRoleSelector(){o.$inject=["scope","el","attr","ctrl"];var e={restrict:"AECM",templateUrl:"assets/views/adminRoleSelector-directive.htm",replace:!0,scope:{category:"=",role:"="},link:o,controller:l,controllerAs:"vm",bindToController:!0};function o(l,e,o,t){l.$watch("vm.role",function(e,o){console.log("role: ",l.vm.role),null!=l.vm.allRoles[e]?l.vm.category=l.vm.allRoles[e].name:l.vm.category=""})}function l(e,o,l){console.log("in the adminRoleSelectorController");var t;e.selectionChanged=function(e){console.log("selection changed: ",e)},t=firebase.database().ref("Inventory/Roles"),e.vm.allRoles=l(t)}return l.$inject=["$scope","$log","$firebaseObject"],e}ckc.directive("adminRoleSelector",adminRoleSelector);
function adminSeasonSellector(){n.$inject=["scope","el","attr","ctrl"];var e={restrict:"AECM",templateUrl:"assets/views/adminSeasonSellector-directive.htm",replace:!0,scope:{merchantId:"=",channelId:"=",seasonId:"="},link:n,controller:a,controllerAs:"vm",bindToController:!0};function n(s,e,n,a){s.$watch("seasonName",function(n,e){n&&Object.keys(s.vm.seasons).forEach(function(e){null!=s.vm.seasons[e]&&s.vm.seasons[e].name==n&&(s.vm.seasonId=e)})}),s.$watch("channelId",function(e,n){var a;null!=s.vm.channelId&&(a="/Merchants/"+s.vm.merchantId+"/Channels/"+s.vm.channelId+"/Seasons",s.vm.initFirebase(a))})}function a(e,n,a){e.seasonName="";var s=this;s.initFirebase=function(e){console.log("init firebase",e);e=firebase.database().ref(e);s.seasons=a(e)}}return a.$inject=["$scope","$log","$firebaseObject"],e}ckc.directive("adminSeasonSellector",adminSeasonSellector);
function adminShippingOrder(){t.$inject=["scope","el","attr","ctrl"];var e={restrict:"AECM",templateUrl:"assets/views/adminShippingOrder-directive.htm",replace:!0,scope:{eventId:"=",eventData:"="},link:t,controller:r,controllerAs:"vm",bindToController:!0};function t(r,e,t,n){r.$watch("eventId",function(e,t){null!=r.vm.eventId&&r.vm.initFirebase("/Projections/Shipping")})}function r(o,e,a){o.vm.roleOptions={};var i=firebase.database(),t=i.ref("Inventory/Roles"),r=i.ref("Inventory/Items");o.vm.itemRoles=a(t),o.vm.allItems=a(r);r=this;r.initFirebase=function(r){console.log("init firebase",r);var n=firebase.database(),e=n.ref(r).orderByChild("eventId").equalTo(o.vm.eventId);console.log("event data: ",o.vm.eventData),o.vm.eventData.simpleDate=o.vm.eventData.schedule.startsAt.split("T")[0],e.once("value",function(e){var e=e.val(),t="";Object.keys(e).forEach(function(e){t=e});e=n.ref(r+"/"+t);o.vm.order=a(e),o.vm.order.$loaded().then(function(r){console.log("order loaded",r.items),Object.keys(r.items).forEach(function(e){var t=r.items[e].role,e=n.ref("Inventory/Items");o.vm.roleOptions[t]=a(e.orderByChild("role").equalTo(t))})}).catch(function(e){console.error("Error:",e)})})},r.createBlankShippingOrder=function(){console.log("creating blank shipping order");var e=new Date(Date.now()).toISOString(),t="Projections/Shipping",r=i.ref(t).push().key,n=i.ref(t+"/"+r);n.set({_createdAt:e,_updatedAt:e,_createdBy:"admin",_updatedBy:"admin",_id:r,eventId:o.vm.eventId},function(e){e&&console.log("write error",e),o.vm.order=a(n)})},r.createShippingOrderFromTemplate=function(){console.log("creating shiping order from template")},r.loadRoleItems=function(e){console.log("loading role id: ",e)},r.saveOrder=function(){var e=new Date(Date.now()).toISOString();o.vm.order.updatedAt=e,o.vm.order.updatedBy="admin",console.log("saving order and items"),Object.keys(o.vm.order.items).forEach(function(e){var t=o.vm.order.items[e].item,r=o.vm.eventData.simpleDate;null==o.vm.allItems[t].usage[r]&&(o.vm.allItems[t].usage[r]=[]),console.log(e,o.vm.allItems[t]),o.vm.allItems[t].usage[r].push({status:"reserved",event:o.vm.eventId})});var t=o.vm.order.$save(),e=o.vm.allItems.$save();Promise.all([t,e]).then(function(e){console.log("success: ",e)}).catch(function(e){console.log("Error: ",e)})},r.addItem=function(){o.vm.order.items.push({category:"",role:""})}}return r.$inject=["$scope","$log","$firebaseObject"],e}ckc.directive("adminShippingOrder",adminShippingOrder);
function ledgersView(){t.$inject=["scope","el","attr","ctrl"];var e={restrict:"AECM",templateUrl:"assets/views/ledgers-directive.htm",replace:!0,scope:{},link:t,controller:r,controllerAs:"vm",bindToController:!0};function t(e,t,r,c){}function r(e,t,r){var c=firebase.database().ref("/Merchants/-MVrZajcORbaTjkuZL2a/AssetAccts");this.accounts=r(c),console.log("this is the ledger directive")}return r.$inject=["$scope","$log","$firebaseObject"],e}ckc.directive("ledgersView",ledgersView);
function teamAllMfgTxs(){t.$inject=["scope","el","attr","ctrl"];var e={restrict:"AECM",templateUrl:"assets/views/directives/team-allMfgTxs-directive.htm",replace:!0,scope:{txs:"="},link:t,controller:c,controllerAs:"vm",bindToController:!0};function t(e,t,c,l){e.$watch("vm.txs",function(e,t){})}function c(e,t,c){}return c.$inject=["$scope","$log","$firebaseObject"],e}ckc.directive("teamAllMfgTxs",teamAllMfgTxs);
function teamCookTimeChart(){d.$inject=["scope","el","attr","ctrl"];var l={restrict:"AECM",templateUrl:"assets/views/directives/team-cookTimeChart-directive.htm",replace:!0,scope:{merchantId:"=",channelId:"="},link:d,controller:a,controllerAs:"vm",bindToController:!0};function d(l,d,a,e){}function a(l,d,a){console.log("teamCookTimeChartController");l.vm.schedule={minInt:"15",slots:{"2021-05-01T08:30:00-08:00":{wasFullfilled:!1,sku:"",hasAddnl:!1,addSku:""},"2021-05-01T08:45:00-08:00":{wasFullfilled:!1,sku:"",hasAddnl:!1,addSku:""},"2021-05-01T09:00:00-08:00":{wasFullfilled:!1,sku:"",hasAddnl:!1,addSku:""},"2021-05-01T09:15:00-08:00":{wasFullfilled:!1,sku:"",hasAddnl:!1,addSku:""},"2021-05-01T09:30:00-08:00":{wasFullfilled:!1,sku:"",hasAddnl:!1,addSku:""},"2021-05-01T09:45:00-08:00":{wasFullfilled:!1,sku:"",hasAddnl:!1,addSku:""},"2021-05-01T10:00:00-08:00":{wasFullfilled:!1,sku:"",hasAddnl:!1,addSku:""},"2021-05-01T10:15:00-08:00":{wasFullfilled:!1,sku:"",hasAddnl:!1,addSku:""},"2021-05-01T10:30:00-08:00":{wasFullfilled:!1,sku:"",hasAddnl:!1,addSku:""},"2021-05-01T10:45:00-08:00":{wasFullfilled:!1,sku:"",hasAddnl:!1,addSku:""},"2021-05-01T11:00:00-08:00":{wasFullfilled:!1,sku:"",hasAddnl:!1,addSku:""},"2021-05-01T11:15:00-08:00":{wasFullfilled:!1,sku:"",hasAddnl:!1,addSku:""},"2021-05-01T11:30:00-08:00":{wasFullfilled:!1,sku:"",hasAddnl:!1,addSku:""}}}}return a.$inject=["$scope","$log","$firebaseObject"],l}ckc.directive("teamCookTimeChart",teamCookTimeChart);
function teamCookedSupplyLevels(){t.$inject=["scope","el","attr","ctrl"];var e={restrict:"AECM",templateUrl:"assets/views/directives/team-cookedSupplyLevels-directive.htm",replace:!0,scope:{merchantId:"=",channelId:"="},link:t,controller:c,controllerAs:"vm",bindToController:!0};function t(e,t,c,l){}function c(e,t,c){}return c.$inject=["$scope","$log","$firebaseObject"],e}ckc.directive("teamCookedSupplyLevels",teamCookedSupplyLevels);
function teamRawSupplyLevels(){l.$inject=["scope","el","attr","ctrl"];var e={restrict:"AECM",templateUrl:"assets/views/directives/team-rawSupplyLevels-directive.htm",replace:!0,scope:{supplies:"=",orders:"="},link:l,controller:p,controllerAs:"vm",bindToController:!0};function l(p,e,l,s){p.$watch("vm.supplies",function(e,l){null!=p.vm.supplies&&p.vm.orders&&p._updateSupplyLevels()})}function p(e,l,p,s){e._updateSupplyLevels=function(){console.log("updating supply levels"),e.vm.supplies=s.buildMfgReportSupplyLevels({supplies:e.vm.supplies,orders:e.vm.orders})}}return p.$inject=["$scope","$log","$firebaseObject","logicService"],e}ckc.directive("teamRawSupplyLevels",teamRawSupplyLevels);
function teamRecordCooking(){s.$inject=["scope","el","attr","ctrl"];var e={restrict:"AECM",templateUrl:"assets/views/directives/team-recordCooking-directive.htm",replace:!0,scope:{orders:"=",supplies:"="},link:s,controller:c,controllerAs:"vm",bindToController:!0};function s(e,s,c,t){}function c(i,e,s,o,c){console.log("teamRecordCookingController");i.vm.areFullBatches=!0,i.vm.recipies={"SS Pecans":{isSelected:!1,classes:["btn-outline-info"],product:{fbsku:"330SSPCN",hbsku:"",qty:1}},"SS Hazelnuts":{isSelected:!1,classes:["btn-outline-info"],product:{fbsku:"360SSHZL",hbsku:"",qty:1}},"SS Almonds":{isSelected:!1,classes:["btn-outline-info"],product:{fbsku:"360SSALM",hbsku:"",qty:1}},"SS Cashews":{isSelected:!1,classes:["btn-outline-info"],product:{fbsku:"320SSCSH",hbsku:"",qty:1}},"SS Peanuts":{isSelected:!1,classes:["btn-outline-info"],product:{fbsku:"400SSPNT",hbsku:"",qty:1}},"Bb Pecans":{isSelected:!1,classes:["btn-outline-warning"],product:{fbsku:"330BNPCN",hbsku:"",qty:1}},"Bb Hazelnuts":{isSelected:!1,classes:["btn-outline-warning"],product:{fbsku:"360BNHZL",hbsku:"",qty:1}},"Bb Almonds":{isSelected:!1,classes:["btn-outline-warning"],product:{fbsku:"360BNALM",hbsku:"",qty:1}}},i.vm.btnClick=function(s){var c,t,e;console.log("clicked: ",s),i.vm.recipies[s].isSelected?(console.log("second click"),c=moment().format("YYYY-MM-DDTHH:mm:ssZ"),e="",e=i.vm.areFullBatches?i.vm.recipies[s].product.fbsku:i.vm.recipies[s].product.hbsku,(t={sku:"",qty:1,description:"",updates:{}}).sku=e,o.mfg.collectSku(e).then(function(e){console.log("got this sku record: ",e),t.description=e.name,t.updates=e.components,console.log("order to write: ",t),i.vm.orders[c]=t,Object.keys(t.updates).forEach(function(e){i.vm.supplies[e].qty+=t.updates[e]}),i.$apply()}).catch(function(e){console.log("Error: ",e)})):(console.log("first click",i.vm.recipies[s].classes[0]),"btn-outline-info"==i.vm.recipies[s].classes[0]&&(i.vm.recipies[s].classes=["btn-info"]),"btn-outline-warning"==i.vm.recipies[s].classes[0]&&(i.vm.recipies[s].classes=["btn-warning"]),Object.keys(i.vm.recipies).forEach(function(e){e==s||(i.vm.recipies[e].isSelected=!1,"btn-info"==i.vm.recipies[e].classes[0]&&(i.vm.recipies[e].classes=["btn-outline-info"]),"btn-warning"==i.vm.recipies[e].classes[0]&&(i.vm.recipies[e].classes=["btn-outline-warning"]))})),i.vm.recipies[s].isSelected=!i.vm.recipies[s].isSelected}}return c.$inject=["$scope","$log","$firebaseObject","FirebaseService","logicService"],e}ckc.directive("teamRecordCooking",teamRecordCooking);
function config(e,l){l.hashPrefix(""),e.when("/",{redirectTo:"/login"}).when("/login",{templateUrl:"assets/views/login-page.htm",controller:"loginController",controllerAs:"vm"}).when("/team/:memberId",{templateUrl:"assets/views/teamDash-page.htm",controller:"teamDashController",controllerAs:"vm"}).when("/team/:memberId/checklists/setup/:shippingReportId",{templateUrl:"assets/views/team-setupChecklist-page.htm",controller:"teamSetupChecklistController",controllerAs:"vm"}).when("/team/:memberId/checklists/closing/:shippingReportId",{templateUrl:"assets/views/teamClosingChecklist-page.htm",controller:"teamClosingReportController",controllerAs:"vm"}).when("/team/:memberId/reports/mfg/:mfgReportId",{templateUrl:"assets/views/team-mfgReport-page.htm",controller:"teamMfgReportController",controllerAs:"vm"}).when("/admin",{templateUrl:"assets/views/adminDash-page.htm",controller:"adminDashController",controllerAs:"vm"}).when("/admin/planning/:merchId",{templateUrl:"assets/views/adminPlanning-page.htm",controller:"adminPlanningController",controllerAs:"vm"}).when("/admin/planning/:merchId/:channelId/:seasonId/:eventId",{templateUrl:"assets/views/adminPlanning-page.htm",controller:"adminPlanningController",controllerAs:"vm"}).when("/admin/channels",{templateUrl:"assets/views/adminChannels-page.htm",controller:"adminChannelsController",controllerAs:"vm"}).when("/admin/channel/:channelId",{templateUrl:"assets/views/adminChannel-page.htm",controller:"adminChannelController",controllerAs:"vm"}).when("/admin/shifts/assign",{templateUrl:"assets/views/admin-shiftsAssignment-page.htm",controller:"adminShiftAssignmentController",controllerAs:"vm"}).when("/admin/shipping_orders/build",{templateUrl:"assets/views/admin-buildShippingOrders-page.htm",controller:"adminBuildShippingOrdersController",controllerAs:"vm"}).when("/admin/ledgers",{templateUrl:"assets/views/admin-allLedgers-page.htm",controller:"adminAllLedgersController",controllerAs:"vm"}).otherwise({redirectTo:"/"})}config.$inject=["$routeProvider","$locationProvider"],angular.module("ckc").config(config);
function FirebaseService(e,n){return e.info("Instanciating FirebaseService Factory"),{value:"something",read:function(e){return 11},mfg:{collectSku:function(e){console.log("CollectSku got this order: ",e);var e="Inventory/MFG/"+e,r=firebase.database().ref(e);return new Promise(function(n,e){r.on("value",function(e){n(e.val())})})}},test:function(){console.log("firebase Mod Test")}}}ckc.factory("FirebaseService",FirebaseService),FirebaseService.$inject=["$log","$http"];
function logicService(e){return e.info("Instanciating logicService Factory"),{buildMfgReportSupplyLevels:function(e){console.log("building mfg report supply levels",e);var i=e.supplies,o=e.orders;return Object.keys(i).forEach(function(e){i[e].qty=0}),Object.keys(o).forEach(function(c){var e=o[c].sku;Object.keys(o[c].updates).forEach(function(e){i[e].qty+=o[c].updates[e]}),"330SSPCN"!=e&&"360SSHZL"!=e&&"360SSALM"!=e&&"320SSCSH"!=e&&"400SSPNT"!=e&&"330BNPCN"!=e&&"360BNHZL"!=e&&"360BNALM"!=e||(i[e].qty+=o[c].qty)}),i}}}ckc.factory("logicService",logicService),logicService.$inject=["$log"];
function adminBuildShippingOrdersController(r,i,n){i.info("in the build shipping orders controller",n)}ckc.controller("adminBuildShippingOrdersController",adminBuildShippingOrdersController),adminBuildShippingOrdersController.$inject=["$scope","$log","$routeParams"];
function adminAllLedgersController(l,e){e.info("in the all ledgers controller")}ckc.controller("adminAllLedgersController",adminAllLedgersController),adminAllLedgersController.$inject=["$scope","$log","$routeParams"];
function adminPlanningController(n,e,a,l){console.log(a);var t;this.model={merchantId:a.merchId,channelId:a.channelId,seasonId:a.seasonId,eventId:a.eventId,eventData:{},document:""},null!=a.eventId&&(t=firebase.database(),a="Merchants/"+a.merchId+"/Events/"+a.eventId,a=t.ref(a),this.model.eventData=l(a)),e.info("in the admin planning controller")}ckc.controller("adminPlanningController",adminPlanningController),adminPlanningController.$inject=["$scope","$log","$routeParams","$firebaseObject"];
function adminShiftAssignmentController(n,t,i){t.info("in the admin shift assignment controller",i)}ckc.controller("adminShiftAssignmentController",adminShiftAssignmentController),adminShiftAssignmentController.$inject=["$scope","$log","$routeParams"];
function adminChannelController(n,l,o){l.info("in the admin channel controller",o)}ckc.controller("adminChannelController",adminChannelController),adminChannelController.$inject=["$scope","$log","$routeParams"];
function adminChannelsController(n,l,o){l.info("in the admin channels controller",o)}ckc.controller("adminChannelsController",adminChannelsController),adminChannelsController.$inject=["$scope","$log","$routeParams"];
function adminDashController(n,o){o.info("in the admin dash controller")}ckc.controller("adminDashController",adminDashController),adminDashController.$inject=["$scope","$log"];
function loginController(o,l){l.info("in the login controller")}ckc.controller("loginController",loginController),loginController.$inject=["$scope","$log"];
function teamClosingReportController(o,r,e){r.info("in the closing report controller",e)}ckc.controller("teamClosingReportController",teamClosingReportController),teamClosingReportController.$inject=["$scope","$log","$routeParams"];
function teamDashController(o,e,t){e.info("in the team dash controller",t)}ckc.controller("teamDashController",teamDashController),teamDashController.$inject=["$scope","$log","$routeParams"];
function teamMfgReportController(e,o,r,t,n){o.info("in the manufacturing report controller",r);var r="Actualizations/Mfg/"+r.mfgReportId,r=firebase.database().ref(r),l=this,c=t(r);c.$bindTo(e,"vm.report").then(function(){console.log(l.report)}).catch(function(o){console.log("Error: ",o)}),c.$loaded().then(function(o){e.vm.report.supplies=n.buildMfgReportSupplyLevels(o),c.$save().then(function(o){console.log("db load updates saved")}).catch(function(o){console.log("error: ",o)})}).catch(function(o){console.log("Error: ",o)})}ckc.controller("teamMfgReportController",teamMfgReportController),teamMfgReportController.$inject=["$scope","$log","$routeParams","$firebaseObject","logicService"];
function teamSetupChecklistController(e,t,o,r){t.info("in the setup checklist controller",o);o="Actualizations/Shipping/"+o.shippingReportId;r(firebase.database().ref(o)).$bindTo(e,"vm.report").then(function(){})}ckc.controller("teamSetupChecklistController",teamSetupChecklistController),teamSetupChecklistController.$inject=["$scope","$log","$routeParams","$firebaseObject"];